<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./styles/styles.css">
  <title>Repaso PP</title>
</head>

<body>
  <section id="form-datos">
    <h1>Listado Personas</h1>
    <div class="filtro">
      <label for="filtrar">Filtrar por:</label>
      <select name="filtrar" id="filtrar">
        <option value="todos">Todos</option>
        <option value="empleados">Empleados</option>
        <option value="clientes">Clientes</option>
      </select>
    </div>

    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Edad</th>
          <th>Ventas/Compras</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tabla-personas">

      </tbody>
    </table>

    <button id="calcular-promedio">Calcular Promedio de Edad</button>
    <p id="promedio-edad"></p>
  </section>

  <section id="form-abm" style="display: none;">
    <h2>Fomulario ABM</h2>
    <form id="abm-form">
      <label for="nombre">Nombre:</label>
      <input type="text" id="nombre" required>

      <label for="apellido">Apellido:</label>
      <input type="text" id="apellido" required>

      <label for="edad">Edad:</label>
      <input type="number" id="edad" required>

      <label for="ventas-compras">Compras/Ventas:</label>
      <input type="number" id="ventas-compras" required>

      <button type="submit">Guardar</button>
    </form>
    <button id="volver">Volver al Listado</button>
  </section>

  <script>
    // Declaración de clases
    class Persona {
      static contadorId = 0;
      #id;
      nombre;
      apellido;
      edad;
  
      constructor(pNombre, pApellido, pEdad) {
        this.#id = ++Persona.contadorId;
        this.nombre = pNombre;
        this.apellido = pApellido;
        this.edad = pEdad;
      }
  
      // Métodos Get y Set
      get GetNombre() {
        return this.nombre;
      }
  
      set SetNombre(nombre) {
        if (nombre) {
          this.nombre = nombre;
        } else {
          throw "El nombre está vacío";
        }
      }
  
      get GetApellido() {
        return this.apellido;
      }
  
      set SetApellido(apellido) {
        if (apellido) {
          this.apellido = apellido;
        } else {
          throw "El apellido está vacío";
        }
      }
  
      get GetEdad() {
        return this.edad;
      }
  
      set SetEdad(edad) {
        if (edad > 15) {
          this.edad = edad;
        } else {
          throw "La edad debe ser mayor a 15";
        }
      }
  
      MostrarDatos() {
        return `Nombre y Apellido -${this.GetNombre} ${this.GetApellido} - Edad: ${this.GetEdad}`;
      }
    }
  
    class Empleado extends Persona {
      sueldo;
      ventas;
  
      constructor(eNombre, eApellido, eEdad, eSueldo, eVentas) {
        super(eNombre, eApellido, eEdad);
        this.sueldo = eSueldo;
        this.ventas = eVentas;
      }
  
      get GetSueldo() {
        return this.sueldo;
      }
  
      set SetSueldo(sueldo) {
        if (sueldo > 0) {
          this.sueldo = sueldo;
        } else {
          throw "El sueldo debe ser positivo";
        }
      }
  
      get GetVentas() {
        return this.ventas;
      }
  
      set SetVentas(ventas) {
        if (ventas > 0) {
          this.ventas = ventas;
        } else {
          throw "Las ventas deben ser positivas";
        }
      }
  
      MostrarDatosEmpleados() {
        return `${super.MostrarDatos()} - Sueldo: ${this.GetSueldo} - Ventas: ${this.GetVentas}`;
      }
  
    }
  
    class Cliente extends Persona {
      compras;
      telefono;
  
      constructor(cNombre, cApellido, cEdad, cCompras, cTelefono) {
        super(cNombre, cApellido, cEdad);
        this.compras = cCompras;
        this.telefono = cTelefono;
      }
  
      get GetCompras() {
        return this.compras;
      }
  
      set SetCompras(compras) {
        if (compras > 0) {
          this.compras = compras;
        } else {
          throw "Las compras deben ser mayores a 0";
        }
      }
  
      get GetTelefono() {
        return this.telefono;
      }
  
      set SetTelefono(telefono) {
        if (telefono) {
          this.telefono = telefono;
        } else {
          throw "El teléfono está vacío";
        }
      }
  
      MostrarDatosCliente() {
        return `${super.MostrarDatos()} - Compras: ${this.GetCompras} - Teléfono: ${this.GetTelefono}`;
      }
    }
  
    // Datos iniciales de personas
    let personas = [
      { id: 1, nombre: "Marcelo", apellido: "Luque", edad: 45, ventas: 15000, sueldo: 2000 },
      { id: 2, nombre: "Ramiro", apellido: "Escobar", edad: 35, ventas: 6000, sueldo: 1000 },
      { id: 3, nombre: "Facundo", apellido: "Cairo", edad: 30, ventas: 500, sueldo: 15000 },
      { id: 4, nombre: "Fernando", apellido: "Nieto", edad: 18, compras: 8000, telefono: "152111131" },
      { id: 5, nombre: "Manuel", apellido: "Loza", edad: 20, compras: 50000, telefono: "42040077" },
      { id: 666, nombre: "Nicolas", apellido: "Serrano", edad: 23, compras: 7000, telefono: "1813181563" }
    ];
  
    let filtroSeleccionado = 'todos';
  
    document.addEventListener('DOMContentLoaded', () => {
      const tablaPersonas = document.getElementById('tabla-personas');
      const filtro = document.getElementById('filtrar');
      const promedioEdad = document.getElementById('promedio-edad');
      const calcularPromedioBtn = document.getElementById('calcular-promedio');
      const formABM = document.getElementById('form-abm');
      const formDatos = document.getElementById('form-datos');
      const volverBtn = document.getElementById('volver');
  
      // Mostrar datos en tabla
      function mostrarDatos() {
        tablaPersonas.innerHTML = '';
        const filtradas = personas.filter(p => {
          if (filtroSeleccionado === 'todos') return true;
          if (filtroSeleccionado === 'empleados') return p.sueldo !== undefined;
          if (filtroSeleccionado === 'clientes') return p.telefono !== undefined;
        });
  
        filtradas.forEach(p => {
          const row = document.createElement('tr');
          row.innerHTML = `
          <td>${p.id}</td>
          <td>${p.nombre}</td>
          <td>${p.apellido}</td>
          <td>${p.edad}</td>
          <td>${p.ventas || p.compras}</td>
          <td><button onclick="editarPersona(${p.id})">Editar</button></td>
        `;
          tablaPersonas.appendChild(row);
        });
      }
  
      // Filtrar datos
      filtro.addEventListener('change', (e) => {
        filtroSeleccionado = e.target.value;
        mostrarDatos();
      });
  
      // Calcular promedio de edad
      calcularPromedioBtn.addEventListener('click', () => {
        const filtradas = personas.filter(p => {
          if (filtroSeleccionado === 'todos') return true;
          if (filtroSeleccionado === 'empleados') return p.sueldo !== undefined;
          if (filtroSeleccionado === 'clientes') return p.telefono !== undefined;
        });
  
        const promedio = filtradas.reduce((sum, p) => sum + p.edad, 0) / filtradas.length;
        promedioEdad.textContent = `Promedio de edad: ${promedio.toFixed(2)}`;
      });
  
      // Editar persona
      window.editarPersona = function (id) {
        const persona = personas.find(p => p.id === id);
        if (persona) {
          document.getElementById('nombre').value = persona.nombre;
          document.getElementById('apellido').value = persona.apellido;
          document.getElementById('edad').value = persona.edad;
          document.getElementById('ventas-compras').value = persona.ventas || persona.compras;
  
          formDatos.style.display = 'none';
          formABM.style.display = 'block';
        }
      };
  
      // Volver al listado
      volverBtn.addEventListener('click', () => {
        formDatos.style.display = 'block';
        formABM.style.display = 'none';
      });
  
      // Inicializar datos
      mostrarDatos();
    });
  
  </script>
</body>
</html>